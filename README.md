# WB-L0 Demo Order Service

## Описание

Демонстрационный микросервис на Go для отображения данных о заказах. Сервис получает данные заказов из Kafka, сохраняет их в PostgreSQL и кэширует в памяти для быстрого доступа. Предусмотрен HTTP API и простой веб-интерфейс для просмотра информации о заказе по его ID.

## Функционал

- Получение заказов из Kafka
- Сохранение заказов в PostgreSQL
- Кэширование заказов в памяти (map)
- Восстановление кэша из БД при старте сервиса
- HTTP API для получения заказа по ID (JSON)
- Веб-страница для поиска заказа по ID

## Быстрый старт
```bash
docker compose up --build
```
### 1. Миграции
```bash
docker compose run --rm migrate up #запускаем контейнер с миграциями
```
### 2. Запуск Kafka
```bash
make create-topic #может быть небольшая задержка при запуске кафки, поэтому запрос может сначала не пройти, но когда кафка настроится топик создастся
```
### 3. Запуск сервиса
```bash
docker compose up wb-service #начало работы самого сервиса, старт консьюмера
```

### 4. HTTP API

- Получить заказ по ID:  
  `GET /api/order/{order_id}`

### 5. Веб-интерфейс

- Откройте страницу (например, `http://localhost:8081/`), введите ID заказа и получите информацию.

## Архитектура

- **Go** — основной язык разработки
- **PostgreSQL** — хранение заказов
- **Kafka** — получение заказов из очереди
- **In-memory cache (map)** — кэширование реализовано через map
- **HTTP сервер** — API и веб-интерфейс

## Восстановление кеша

При запуске сервис загружает последние N заказов(количество задается в конфиге) из БД в память для минимизации задержек при обслуживании запросов.

## Пример запроса

```bash
curl -X GET http://localhost:8081/order/test-1756564844007554477
```
